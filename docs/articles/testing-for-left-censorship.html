<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ICIKendallTau">
<title>Testing for Left Censorship • ICIKendallTau</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Testing for Left Censorship">
<meta property="og:description" content="ICIKendallTau">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ICIKendallTau</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ici-kendalltau.html">Information-Content-Informed Kendall Tau Correlation</a>
    <a class="dropdown-item" href="../articles/testing-for-left-censorship.html">Testing for Left Censorship</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/moseleybioinformaticslab/ICIKendallTau/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Testing for Left Censorship</h1>
                        <h4 data-toc-skip class="author">Robert M Flight
and Hunter NB Moseley</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/moseleybioinformaticslab/ICIKendallTau/blob/HEAD/vignettes/testing-for-left-censorship.Rmd" class="external-link"><code>vignettes/testing-for-left-censorship.Rmd</code></a></small>
      <div class="d-none name"><code>testing-for-left-censorship.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://moseleybioinformaticslab.github.io/ICIKendallTau/" class="external-link">ICIKendallTau</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="why">Why?<a class="anchor" aria-label="anchor" href="#why"></a>
</h2>
<p>{ICIKendallTau} has a very specific assumption, that the missing
values are <strong>largely</strong> due to being below the limit of
detection, or the result of left-censorship. Therefore, it should only
be used <strong>if</strong> the missing values are from left-censorship.
Ideally, it would be nice to have a way to test for it.</p>
</div>
<div class="section level2">
<h2 id="strategy">Strategy<a class="anchor" aria-label="anchor" href="#strategy"></a>
</h2>
<p>To test this, we do the following (implemented in
<code>test_left_censorship</code>). For any feature that is missing in
one or more samples in a class of samples, we check if the non-missing
entries are below their sample’s median values. We count all of the
entries below sample medians as successes, and the total number of
possible entries as the number of trials in a binomial test, aggregating
across all features that had a missing value. We can then perform a
one-tailed binomial test with the expectation that the successes are
greater than 0.5.</p>
</div>
<div class="section level2">
<h2 id="fake-data">Fake Data<a class="anchor" aria-label="anchor" href="#fake-data"></a>
</h2>
<p>To start, we need to make some fake data that we can evaluate the
test on. We will make a smallish dataset, with 1000 features across 20
samples, and we will have 80% of the missing values be due to being
left-censored.</p>
<p>We sort the initial data so we know where we can easily put
missingness due to left-censoring. We also use a log-normal distribution
initially, just because.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n_feature</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="va">n_sample</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="va">n_miss</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">n_low</span> <span class="op">=</span> <span class="fl">80</span></span>
<span><span class="va">test_dataset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n_feature</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">test_dataset</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">test_dataset</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">noisy_dataset</span> <span class="op">=</span> <span class="fu"><a href="../reference/add_uniform_noise.html">add_uniform_noise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">test_dataset</span><span class="op">)</span>, <span class="va">n_sample</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">sample_medians</span> <span class="op">=</span> <span class="fu"><a href="../reference/calculate_matrix_medians.html">calculate_matrix_medians</a></span><span class="op">(</span><span class="va">noisy_dataset</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-missingness">Add Missingness<a class="anchor" aria-label="anchor" href="#add-missingness"></a>
</h2>
<p>Now we can sample some low and high indices to add our missingness,
as well as some samples to add them to.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_indices</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span>, <span class="va">n_low</span><span class="op">)</span></span>
<span><span class="va">hi_indices</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="va">n_miss</span> <span class="op">-</span> <span class="va">n_low</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">all_indices</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">low_indices</span>, <span class="va">hi_indices</span><span class="op">)</span></span>
<span><span class="va">sample_indices</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n_sample</span>, <span class="va">n_miss</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">missing_dataset</span> <span class="op">=</span> <span class="va">noisy_dataset</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i_loc</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">all_indices</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">missing_dataset</span><span class="op">[</span><span class="va">all_indices</span><span class="op">[</span><span class="va">i_loc</span><span class="op">]</span>, <span class="va">sample_indices</span><span class="op">[</span><span class="va">i_loc</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can actually visualize the missingness using the
<code>naniar</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">naniar</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/visdat/reference/vis_miss.html" class="external-link">vis_miss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">missing_dataset</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="testing-for-left-censorship_files/figure-html/examine-missingness-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="test">Test<a class="anchor" aria-label="anchor" href="#test"></a>
</h2>
<p>Now we can actually test the missingness entries.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">missing_test</span> <span class="op">=</span> <span class="fu"><a href="../reference/test_left_censorship.html">test_left_censorship</a></span><span class="op">(</span><span class="va">missing_dataset</span><span class="op">)</span></span>
<span><span class="va">missing_test</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt;   trials success class</span></span>
<span><span class="co">#&gt; 1   1900    1520     A</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $binomial_test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Exact binomial test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  total_success and total_trials</span></span>
<span><span class="co">#&gt; number of successes = 1520, number of trials = 1900, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true probability of success is greater than 0.5</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.7843033 1.0000000</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; probability of success </span></span>
<span><span class="co">#&gt;                    0.8</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robert M Flight, Hunter NB Moseley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
